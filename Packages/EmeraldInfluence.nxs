{"type":"group","name":"EmeraldInfluence","enabled":true,"items":[{"type":"function","name":"onInstall","enabled":true,"code":"let emerald = client.emerald;\nlet influence = emerald.influence = {\n  name: 'EmeraldInfluence',\n  version:'0.0.1',\n  attacks:{'charity':[],'paranoia':[],'weakening':[],'empowering':[],'seduction':[],'village':[]},\n  target: null,\n  mode: 'charity',\n  active: false,\n  atkIndex: 0\n};\ninfluence.xlate = {\n  'begging':'charity','supplication':'charity','wheedling':'charity',\n  'rumours':'paranoia','distrust':'paranoia','conspiracies':'paranoia',\n  'teasing':'weakening','mockery':'weakening','derision':'weakening',\n  'compliments':'empowering','admiration':'empowering','praise':'empowering',\n  'flattery':'seduction','charm':'seduction','beguiling':'seduction',  \n  'accordance':'village','collaboration':'village','assimilation':'village',\n  'manipulation':'village','intrigue':'village','trickery':'village',\n  'proselytising':'village','preaching':'village','evangelising':'village',\n  'lectures':'village','recitation':'village','oration':'village',\n  'liberty':'village','freedom':'village','revolution':'village',\n  'shock':'village','awe':'village','brainwash':'village'\n}\n\nif (get_variable('emerald_skills_influence')) {\n  let infskills = get_variable('emerald_skills_influence').split('|');\n  let xlate = influence.xlate\n  infskills.forEach(s => {\n    let skl = s.toLowerCase()\n    if (xlate.hasOwnProperty(skl)) influence.attacks[xlate[skl]].push(skl);\n  })\n}\n\ninfluence.try = () => {\n  emerald.debugmsg(`Trying influence. Mode:${influence.mode}. Target:${influence.target} Attack count: ${influence.attacks[influence.mode].length}`)\n  influence.atkIndex = ++influence.atkIndex % 3;\n  send_command(`influence ${influence.target} with ${influence.attacks[influence.mode][influence.atkIndex]}`);\n}\n\ninfluence.onPrompt = () => {\n  if (influence.active && influence.mode && influence.target && emerald.bals.onbal) {\n    influence.try();\n  }\n  return true;\n}\n\nemerald.plugins['influence'] = influence;\nemerald.emnote(`${influence.name} v${influence.version} initialised.`);"},{"type":"function","name":"onUninstall","enabled":true,"code":"// Place any code here you'd like to autorun when the package is uninstalled"},{"type":"function","name":"onGMCP","enabled":true,"code":"if (args.gmcp_method == \"Char.Skills.List\" && args.gmcp_args.group == \"influence\") {\n  let influence = client.emerald.influence;\n  let xlate = influence.xlate;\n  influence.attacks = {'charity':[],'paranoia':[],'weakening':[],'empowering':[],'seduction':[],'village':[]};\n  args.gmcp_args.list.forEach(s => {\n    let skl = s.toLowerCase()\n    if (xlate.hasOwnProperty(skl)) influence.attacks[xlate[skl]].push(skl);\n  });\n}"},{"type":"alias","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"client.emerald.influence.target = args[1];\nclient.emerald.emnote(`Influence target: ${args[1]}`,'Influence');"}],"text":"^it (.+)$","matching":"regexp","whole_words":true,"case_sensitive":true,"prefix_suffix":true},{"type":"alias","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"let inf = client.emerald.influence;\nlet modefilter = ['charity','paranoia','weakening','empowering','seduction','village'].filter(a => a.includes(args[1]));\nif (modefilter.length >0) {\n  inf.mode = modefilter[0];\n  client.emerald.emnote(`Influencing with ${inf.mode}`,'Influence');\n}"}],"text":"^im (char(?:ity)?|par(?:anoia)?|weak(?:en(?:ing)?)?|emp(?:ower(?:ing)?)?|sed(?:uce|uction)?|vil(?:lage)?)$","matching":"regexp","whole_words":true,"case_sensitive":true,"prefix_suffix":true},{"type":"alias","name":"","enabled":true,"actions":[],"text":"^ehelp inf(?:luenc(?:e|ing))?$","matching":"begins","whole_words":true,"case_sensitive":true,"prefix_suffix":true},{"type":"alias","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"let inf = client.emerald.influence;\nif (args[1] && args[1]=='r') inf.repeat = true;\nif (args[2]) inf.target = args[2]\ninf.active = true;\ninf.try();"}],"text":"^inf(r)?\\s?(\\w+)?$","matching":"regexp","whole_words":true,"case_sensitive":true,"prefix_suffix":true},{"type":"alias","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"client.emerald.influence.active = false;\nclient.emerald.emnote('Influence actions reset!','Influence');"}],"text":"is","matching":"exact","whole_words":true,"case_sensitive":true,"prefix_suffix":true},{"type":"group","name":"Influencing Done","enabled":true,"items":[{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"client.emerald.influence.active = false"}],"text":"^(?:.+? is so caught up in admiring (?:him|her)sel(?:f|ves) that (?:he|she|they) barely notices? you|.+ doesn't even seem to notice you\\, as (?:s?he|they) (?:is|are) lost thinking of (?:her|his|their) friendship with you)\\.$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"client.emerald.influence.active = false;\nclient.emerald.influence.repeat = false;"}],"text":"^(?:You cannot see that being here\\.|Ahh\\, I am truly sorry\\, but I do not see anyone by that name here\\.|I do not recognize anything called that here\\.|You detect nothing here by that name\\.|Nothing can be seen here by that name\\.)$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"client.emerald.influence.active = false\nclient.emerald.emnote('!!INFLUENCE IMMUNE!!', 'Influence');"}],"text":"^.+? (?:smiles at you condescendingly and pats your head|tickles you\\, obviously amused by your antics)\\.$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"client.emerald.influence.active = false;\nclient.emerald.influence.repeat = false;"}],"text":"^.+ doesn't even seem to notice your actions, as (?:s?he|the) (?:is|are) lost daydreaming a future living with you\\.$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"let inf = client.emerald.influence;\nif (!inf.repeat) inf.active = false;"}],"text":"^.+ puffs up (?:his|her|their) chest and a crazy gleam enters (?:his|her|their) eyes as (?:s?he|they) vigorously agrees? with you that (?:his|her|their) intelligence and strength far surpass anyone else's\\.$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"let inf = client.emerald.influence;\nif (!inf.repeat) inf.active = false;"}],"text":"^.+ drops down on (?:his|her|their) knees and worships the very ground you walk on\\!$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"client.emerald.influence.active = false;\nclient.emerald.influence.repeat = false;"}],"text":"^You are already attempting another influence on this being\\.$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"let inf = client.emerald.influence;\nif (!inf.repeat) inf.active = false;"}],"text":"^.+ wraps an arm around you\\, declaring you to be the truest of friends\\.$","matching":"regexp","whole_words":true,"case_sensitive":true},{"type":"trigger","name":"","enabled":true,"actions":[{"type":"script","enabled":true,"script":"let inf = client.emerald.influence;\nif (!inf.repeat) inf.active = false;"}],"text":"^.+ says\\, \\\"That sounds interesting, but I\\'m currently considering the .+\\. Perhaps we can talk about it later\\?\\\"$","matching":"regexp","whole_words":true,"case_sensitive":true}]}],"description":"Package for handling influencing and debate"}